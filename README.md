# OpenSeesPy 纤维截面建模工具

## 📖 产品简介

OpenSeesPy 纤维截面建模工具是一个基于PyQt5开发的图形界面应用程序，专门用于OpenSeesPy结构分析软件的纤维截面建模。该工具提供了直观的可视化界面，支持复杂的几何形状创建、材料属性定义、网格划分和OpenSeesPy代码生成。

## 🎯 主要功能

### 🔧 核心模块

#### 1. 纤维截面建模模块
- **几何形状创建**：支持矩形、圆形、多边形等基本形状
- **形状布尔运算**：并集、交集、差集操作
- **材料分配**：为不同区域分配不同材料属性
- **网格自动生成**：基于几何形状和材料特性自动划分网格
- **纤维截面分析**：计算纤维截面特性

#### 2. OpenSeesPy 3D建模模块
- **节点管理**：3D坐标系中的节点创建和编辑
- **材料库**：内置钢筋、混凝土等材料模型
- **截面定义**：定义各种截面类型和属性
- **单元连接**：节点间的单元连接和属性设置
- **3D可视化**：实时显示节点、单元和模型结构

## 🚀 快速开始

### 系统要求
- Python 3.7+
- Windows 10/11 (推荐)
- 4GB+ 内存
- 显卡支持OpenGL 2.0+

### 安装步骤

1. **克隆项目**
```bash
git clone [项目地址]
cd openseespyPRE
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **运行应用**
```bash
cd fiber_section_gui
python main.py
```

## 📚 详细使用指南

### 界面布局

#### 主界面结构
```
┌─────────────────────────────────────────────────────────────┐
│                        菜单栏                                │
├──────────────┬─────────────────────┬────────────────────────┤
│              │                     │                        │
│   左侧面板   │      中心画布       │      右侧面板          │
│              │                     │                        │
│   控制面板   │   2D/3D可视化      │     属性编辑           │
│   - 形状     │   - 截面显示        │   - 参数设置           │
│   - 材料     │   - 网格显示        │   - 节点信息           │
│   - 网格     │   - 3D模型          │   - 单元属性           │
│   - 纤维     │                     │                        │
├──────────────┴─────────────────────┴────────────────────────┤
│                        状态栏                                │
└─────────────────────────────────────────────────────────────┘
```

#### 标签页说明
1. **纤维截面标签页**：用于几何形状创建、材料分配和网格划分
2. **OpenSeesPy建模标签页**：用于3D结构建模和OpenSeesPy代码生成

### 使用流程

#### 第一步：纤维截面设计

##### 1.1 创建几何形状
1. **选择形状类型**
   - 矩形：点击"添加矩形"，设置宽度和高度
   - 圆形：点击"添加圆形"，设置半径
   - 多边形：点击"添加多边形"，手动输入顶点坐标

2. **形状编辑**
   - 选择形状后，在属性面板中修改尺寸参数
   - 拖拽形状顶点进行微调
   - 使用对齐工具精确定位

3. **布尔运算**
   - 并集：将多个形状合并为一个
   - 交集：保留形状重叠部分
   - 差集：从一个形状中减去另一个

##### 1.2 材料定义
1. **创建材料**
   ```
   材料类型选择：
   - 钢筋 (Steel02)
   - 混凝土 (Concrete01) 
   - 弹性材料 (Elastic)
   ```

2. **设置材料参数**
   - **钢筋材料**：
     * 屈服强度 (fy)：400 MPa
     * 弹性模量 (E)：200000 MPa
     * 应变硬化率 (b)：0.01
   
   - **混凝土材料**：
     * 抗压强度 (f'c)：-25 MPa
     * 峰值应变 (εc0)：-0.002
     * 极限应变 (εcu)：-0.01

3. **材料分配**
   - 选择几何区域
   - 从材料库中选择材料
   - 点击"分配材料"

##### 1.3 网格划分
1. **设置网格参数**
   - 网格尺寸：0.1 - 10.0
   - 网格类型：三角形、四边形
   - 全局网格类型设置

2. **生成网格**
   - 点击"生成网格"按钮
   - 检查网格质量
   - 调整参数重新生成

3. **纤维生成**
   - 基于网格自动生成纤维
   - 验证纤维分布
   - 计算截面特性

#### 第二步：3D结构建模

##### 2.1 节点管理
1. **创建节点**
   ```
   方法1：手动输入
   - 点击"添加节点"
   - 输入坐标 (x, y, z)
   - 设置6自由度质量
   
   方法2：从Excel导入
   - 使用提供的节点模板
   - 批量导入节点数据
   ```

2. **节点编辑**
   - 选择节点修改坐标
   - 批量编辑节点属性
   - 节点坐标系变换

##### 2.2 材料管理
1. **材料库操作**
   - 查看现有材料列表
   - 编辑材料参数
   - 复制材料属性

2. **新材料创建**
   ```
   创建步骤：
   1. 点击"新建材料"
   2. 选择材料类型
   3. 输入材料参数
   4. 保存材料定义
   ```

##### 2.3 截面定义
1. **截面类型**
   - 纤维截面：从第一步导入
   - 弹性截面：输入面积和惯性矩
   - 塑性铰截面：自定义截面属性

2. **截面属性**
   - 面积 (A)
   - 惯性矩 (Ix, Iy, Iz)
   - 扭转常数 (J)

##### 2.4 单元创建
1. **单元类型**
   - 梁单元 (beamColumnElement)
   - 桁架单元 (trussElement)
   - 弹簧单元 (zeroLengthElement)

2. **单元连接**
   - 选择起始和结束节点
   - 选择截面类型
   - 设置积分点数量

3. **边界条件**
   - 固定约束：UX, UY, UZ, RX, RY, RZ
   - 弹簧约束：平动和转动弹簧
   - 释放约束：部分自由度释放

##### 2.5 3D可视化
1. **视图控制**
   - 旋转：鼠标左键拖拽
   - 缩放：鼠标滚轮
   - 平移：鼠标右键拖拽

2. **显示选项**
   - 节点显示：编号、坐标、质量
   - 单元显示：类型、颜色、截面信息
   - 材料显示：颜色编码、属性标签

3. **交互功能**
   - 鼠标悬停：显示节点/单元信息
   - 点击选择：高亮显示选中对象
   - 属性编辑：双击对象快速编辑

#### 第三步：代码导出

##### 3.1 OpenSeesPy代码生成
1. **导出选项**
   - 完整模型代码
   - 仅截面定义
   - 仅结构模型
   - 自定义导出范围

2. **代码结构**
   ```python
   # 材料定义
   uniaxialMaterial('Steel02', 1, 400, 200000, 0.01)
   uniaxialMaterial('Concrete01', 2, -25, -0.002, -0.01)
   
   # 截面定义
   section('Fiber', 1, '-GJ', 1e10, '-t', 1, '-A', 300, '-I', 25000, '-y', 150, '-z', 150)
   
   # 节点定义
   node(1, 0, 0, 0)
   node(2, 3, 0, 0)
   
   # 单元定义
   element('elasticBeamColumn', 1, 1, 2, 300, 25000, 1e10, 1)
   ```

##### 3.2 Excel模板导出
1. **节点模板**
   - 节点编号、坐标、质量
   - 支持批量编辑

2. **单元模板**
   - 单元编号、节点连接、截面
   - 材料属性关联

3. **材料模板**
   - 材料参数、强度等级
   - 自定义材料库

## 🔧 高级功能

### 1. 坐标系变换
- **平移变换**：整体坐标系统移动
- **旋转变换**：绕坐标轴旋转
- **缩放变换**：坐标轴方向缩放
- **复合变换**：多个变换组合

### 2. 参数化建模
- **参数定义**：使用变量控制模型尺寸
- **参数关联**：参数间的依赖关系
- **参数优化**：自动寻找最优参数组合

### 3. 批量处理
- **批量创建**：相同类型对象的批量生成
- **批量修改**：同时修改多个对象属性
- **模板应用**：预设模板的快速应用

### 4. 数据验证
- **几何验证**：检查几何形状的有效性
- **连接验证**：验证节点-单元连接关系
- **参数验证**：检查材料参数的合理性

## 🎨 可视化功能

### 2D可视化
- **截面显示**：实时显示截面几何形状
- **网格显示**：网格划分结果可视化
- **材料显示**：不同材料用不同颜色区分
- **纤维显示**：纤维分布和属性显示

### 3D可视化
- **节点显示**：3D空间中的节点位置
- **单元显示**：梁、柱等结构构件
- **变形显示**：结构变形动画
- **应力显示**：应力分布彩色云图

## 📊 数据管理

### 项目文件
- **保存格式**：JSON格式，兼容性强
- **版本控制**：支持项目版本管理
- **备份功能**：自动备份重要数据

### 数据导入导出
- **Excel支持**：节点、单元数据导入导出
- **CSV支持**：批量数据处理
- **图片导出**：高质量图像文件导出

## 🛠️ 故障排除

### 常见问题

#### 1. 程序启动问题
```
问题：程序无法启动
解决方案：
- 检查Python版本 (需要3.7+)
- 重新安装依赖包
- 检查系统兼容性
```

#### 2. 图形显示问题
```
问题：3D视图显示异常
解决方案：
- 更新显卡驱动
- 检查OpenGL版本
- 调整显示设置
```

#### 3. 网格生成失败
```
问题：网格划分失败
解决方案：
- 检查几何形状是否闭合
- 调整网格尺寸参数
- 检查材料分配是否正确
```

#### 4. 内存不足
```
问题：程序运行缓慢或崩溃
解决方案：
- 减少网格密度
- 分步处理大型模型
- 增加系统内存
```

### 性能优化建议
1. **合理设置网格尺寸**：避免过细的网格
2. **分模块处理**：将复杂模型分步骤创建
3. **及时保存**：定期保存工作进度
4. **关闭不需要的功能**：减少内存占用

## 📞 技术支持

### 获取帮助
- **用户手册**：本文档包含详细使用说明
- **示例项目**：查看示例文件学习使用
- **视频教程**：观看操作演示视频

### 反馈渠道
- **问题报告**：通过Issue提交bug报告
- **功能建议**：提出新功能需求
- **用户交流**：参与社区讨论

## 📄 版本历史

### v1.0.0 (当前版本)
- ✅ 纤维截面建模功能
- ✅ OpenSeesPy 3D建模功能  
- ✅ 3D可视化显示
- ✅ 代码导出功能
- ✅ Excel模板导出
- ✅ 坐标系变换功能

### 计划功能
- 🔄 高级材料模型
- 🔄 动力分析模块
- 🔄 参数化建模
- 🔄 云端协作功能

## 📋 系统要求

### 最低要求
- **操作系统**：Windows 10 / macOS 10.14 / Ubuntu 18.04
- **处理器**：Intel Core i3 / AMD Ryzen 3
- **内存**：4GB RAM
- **显卡**：支持OpenGL 2.0
- **存储空间**：2GB可用空间

### 推荐配置
- **操作系统**：Windows 11 / macOS 12+ / Ubuntu 20.04+
- **处理器**：Intel Core i5 / AMD Ryzen 5 或更高
- **内存**：8GB+ RAM
- **显卡**：独立显卡，支持OpenGL 3.0+
- **存储空间**：5GB+ 可用空间

### 依赖软件
- **Python 3.7+**
- **PyQt5 5.15+**
- **Matplotlib 3.3+**
- **NumPy 1.19+**
- **Pandas 1.2+**

## 📝 开发信息

### 项目结构
```
openseespyPRE/
├── fiber_section_gui/          # 主应用程序
│   ├── gui/                    # 图形界面组件
│   │   ├── main_window.py      # 主窗口
│   │   ├── control_panel.py    # 控制面板
│   │   ├── canvas.py           # 画布组件
│   │   ├── openseespy_panel.py # OpenSeesPy面板
│   │   ├── openseespy_3d_view.py # 3D视图
│   │   └── ...
│   ├── openseespy_modeling/    # 建模核心功能
│   │   ├── node_manager.py     # 节点管理
│   │   ├── material_manager.py # 材料管理
│   │   ├── element_manager.py  # 单元管理
│   │   └── ...
│   ├── geometry几何模块/               # 
│   ├── material/               # 材料模块
│   ├── meshing/                # 网格模块
│   └── data/                   # 数据管理
├── docs/                       # 文档
├── utilities/                  # 工具脚本
└── requirements.txt            # 依赖列表
```

### 技术栈
- **GUI框架**：PyQt5
- **数据可视化**：Matplotlib
- **科学计算**：NumPy, SciPy
- **数据处理**：Pandas
- **图像处理**：PIL

### 许可证
MIT License - 详见LICENSE文件

---

*本文档最后更新时间：2025年12月*

*如需技术支持，请查阅本文档或联系开发团队。*